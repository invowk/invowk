# Test: Command flag handling (08-flags.tape equivalent)
# Tests flags: simple, defaults, typed, short, validation

# Run against project's invkfile.cue
cd $PROJECT_ROOT

# Test 1: flags simple - basic flags without defaults
exec invowk cmd 'flags simple'
stdout '=== Simple Flags Demo ==='
stdout 'Flags passed to this command are available as environment variables:'
stdout 'INVOWK_FLAG_VERBOSE'
stdout 'INVOWK_FLAG_OUTPUT'
! stderr .

# Test 2: flags defaults - flags with default values
exec invowk cmd 'flags defaults'
stdout '=== Flags with Defaults Demo ==='
stdout 'These flags have default values if not specified:'
stdout 'INVOWK_FLAG_ENV'
stdout 'INVOWK_FLAG_RETRY_COUNT'
stdout 'INVOWK_FLAG_DRY_RUN'
! stderr .

# Test 3: flags typed - typed flags (bool, int, float, string)
exec invowk cmd 'flags typed'
stdout '=== Typed Flags Demo ==='
stdout 'These flags have explicit types:'
stdout 'INVOWK_FLAG_VERBOSE \(bool\)'
stdout 'INVOWK_FLAG_COUNT \(int\)'
stdout 'INVOWK_FLAG_THRESHOLD \(float\)'
stdout 'INVOWK_FLAG_MESSAGE \(string\)'
! stderr .

# Test 4: flags short - flags with short aliases
# Note: Using -- to separate invowk flags from command flags
exec invowk cmd 'flags short' -- -v
stdout '=== Short Flag Aliases Demo ==='
! stderr .

# Test 5: flags validation - regex-validated flags
# Note: Using -- to separate invowk flags from command flags
exec invowk cmd 'flags validation' -- --env=staging
stdout '=== Flag Validation Demo ==='
stdout 'regex patterns'
! stderr .
