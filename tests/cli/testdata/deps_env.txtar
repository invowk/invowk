# Test: Environment variable dependencies (07-deps-env.tape equivalent)
# Tests the env_vars dependency type
#
# Note: testscript isolates the environment, so we set required vars explicitly

[windows] skip 'deps env commands only have linux/macos implementations'

# Run against project's invkfile.cue
cd $PROJECT_ROOT

# Set required environment variables for the tests
env HOME=/test-home
env USER=testuser

# Test 1: deps env single - requires HOME environment variable
exec invowk cmd 'deps env single'
stdout '=== Single Env Var Dependency Demo ==='
stdout 'Required environment variable is set:'
stdout 'HOME = '
! stderr .

# Test 2: deps env multiple - requires multiple environment variables
exec invowk cmd 'deps env multiple'
stdout '=== Multiple Env Var Dependencies Demo ==='
stdout 'All required environment variables are set:'
stdout 'HOME = '
stdout 'USER = '
stdout 'PATH = '
! stderr .
