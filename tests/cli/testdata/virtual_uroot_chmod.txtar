# Test: U-root chmod utility
# Tests the chmod command for changing file permissions in virtual runtime

cd $WORK

# Test 1: chmod changes file permissions
exec invowk cmd 'uroot chmod'
stdout '=== chmod octal mode ==='
stdout 'rwx'
stdout '=== chmod read-only ==='
stdout '=== uroot chmod test complete ==='
! stderr .

-- invowkfile.cue --
cmds: [
	{
		name:        "uroot chmod"
		description: "Test chmod file permission operations"
		implementations: [{
			script: """
				mkdir -p $WORK/chmod-test
				touch $WORK/chmod-test/script.sh

				# Test octal mode: make executable
				chmod 755 $WORK/chmod-test/script.sh
				echo '=== chmod octal mode ==='
				ls -l $WORK/chmod-test/script.sh

				# Test read-only mode
				chmod 444 $WORK/chmod-test/script.sh
				echo '=== chmod read-only ==='
				ls -l $WORK/chmod-test/script.sh

				rm -rf $WORK/chmod-test
				echo '=== uroot chmod test complete ==='
				"""
			runtimes: [{name: "virtual"}]
			platforms: [{name: "linux"}, {name: "macos"}, {name: "windows"}]
		}]
	},
]
