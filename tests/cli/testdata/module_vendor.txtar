# Test: invowk module vendor
# Vendor reads invowkmod.cue requires field and shows dependency status

cd $WORK

# Test 1: Vendor a module with no requires field - shows "No dependencies declared"
exec invowk module vendor ./vendormod.invowkmod
stdout 'Vendor Module Dependencies'
stdout 'No dependencies declared'

# Test 2: Vendor without a module path and no invowkmod.cue in current dir (should fail)
! exec invowk module vendor
stderr 'invowkmod.cue'

# Test 3: --update flag accepted with no-deps module
exec invowk module vendor --update ./vendormod.invowkmod
stdout 'No dependencies declared'

# Test 4: --prune flag accepted with no-deps module
exec invowk module vendor --prune ./vendormod.invowkmod
stdout 'No dependencies declared'

# Test 5: Non-existent module path
! exec invowk module vendor ./does-not-exist.invowkmod
stderr 'invowkmod.cue'

# Test 6: Plain directory (not a module) â€” missing invowkmod.cue
! exec invowk module vendor ./plaindir
stderr 'module directory'
stderr 'invowkmod.cue'

-- vendormod.invowkmod/invowkmod.cue --
module:  "vendormod"
version: "0.1.0"

-- vendormod.invowkmod/invowkfile.cue --
cmds: [
	{
		name:        "noop"
		description: "A no-op command"
		implementations: [{
			script:    "echo noop"
			runtimes:  [{name: "virtual"}]
			platforms: [{name: "linux"}, {name: "macos"}, {name: "windows"}]
		}]
	},
]

-- plaindir/.gitkeep --
