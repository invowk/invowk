# Test: Watch mode flag recognition using native runtime
# Mirrors virtual_watch.txtar with platform-split native implementations

cd $WORK

# Test 1: --ivk-watch with non-existent command fails cleanly
! exec invowk cmd nonexistent --ivk-watch
stderr '(?i)not found'

# Test 2: --ivk-watch and --ivk-dry-run are mutually exclusive
! exec invowk cmd hello --ivk-watch --ivk-dry-run
stderr '(?i)--ivk-watch and --ivk-dry-run cannot be used together'

-- invowkfile.cue --
cmds: [
	{
		name:        "hello"
		description: "A simple command"
		implementations: [
			{
				script:    "echo hello"
				runtimes:  [{name: "native"}]
				platforms: [{name: "linux"}, {name: "macos"}]
			},
			{
				script:    "Write-Output 'hello'"
				runtimes:  [{name: "native"}]
				platforms: [{name: "windows"}]
			},
		]
	},
]
