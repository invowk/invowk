# Test: Command dependency error path using native runtime
# Mirrors virtual_deps_cmds_error.txtar but with platform-split native implementations

cd $WORK

# Test 1: Missing command dependency should fail
! exec invowk cmd 'deps cmd missing-ref'
stderr '(?i)dependencies not satisfied'
stderr 'Missing Commands'
stderr 'nonexistent-build-cmd'

-- invowkfile.cue --
cmds: [
	{
		name:        "deps cmd missing-ref"
		description: "Command referencing a nonexistent command dependency"
		implementations: [
			{
				script:    "echo 'should not run'"
				runtimes:  [{name: "native"}]
				platforms: [{name: "linux"}, {name: "macos"}]
			},
			{
				script:    "Write-Output 'should not run'"
				runtimes:  [{name: "native"}]
				platforms: [{name: "windows"}]
			},
		]
		depends_on: {
			cmds: [
				{alternatives: ["nonexistent-build-cmd"]},
			]
		}
	},
]
