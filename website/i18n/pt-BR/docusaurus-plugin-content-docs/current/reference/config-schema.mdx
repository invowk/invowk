---
sidebar_position: 3
---

import Snippet from '@site/src/components/Snippet';

# Referência de Schema de Configuração

:::warning Alpha — Opções de Configuração Podem Mudar
O schema de configuração ainda está sendo refinado. Opções **podem ser adicionadas, renomeadas ou removidas** entre releases enquanto finalizamos o conjunto de funcionalidades.
:::

Referência completa para o schema do arquivo de configuração do Invowk™.

## Visão Geral

O arquivo de configuração usa formato [CUE](https://cuelang.org/) e está localizado em:

| Plataforma | Localização |
|------------|-------------|
| Linux      | `~/.config/invowk/config.cue` |
| macOS      | `~/Library/Application Support/invowk/config.cue` |
| Windows    | `%APPDATA%\invowk\config.cue` |

Arquivos de configuração são validados com structs fechadas, então campos desconhecidos geram erro de validação.

## Definição do Schema

<Snippet id="reference/config/schema-definition" />

## Config

O objeto de configuração raiz.

<Snippet id="reference/config/config-structure" />

### container_engine

**Tipo:** `"podman" | "docker"`  
**Obrigatório:** Não  
**Padrão:** `"podman"`

Especifica qual container runtime usar para execução de comandos baseada em container.

<Snippet id="reference/config/container-engine-example" />

Se a engine preferida não estiver disponível, o Invowk faz fallback para a outra quando o runtime container é necessário.

### includes

**Tipo:** `[...#IncludeEntry]`
**Obrigatório:** Não
**Padrão:** `[]`

Módulos adicionais para incluir na descoberta de comandos. Cada entrada especifica um caminho para um diretório `*.invowkmod` com um `alias` opcional para desambiguação de colisões.

<Snippet id="reference/config/includes-example" />

**Requisitos de caminho:**
- Caminhos devem ser absolutos e terminar com `.invowkmod`
- Caminhos inexistentes são ignorados silenciosamente
- Caminhos duplicados são rejeitados

**Regras de alias:**
- Aliases são opcionais, para desambiguação de colisões
- Cada alias deve ser único entre todas as entradas includes

**Prioridade de descoberta (maior para menor):**
1. invowkfile do diretório atual
2. Módulos locais (`*.invowkmod` no diretório atual)
3. `includes` configurados (em ordem) — includes explícitos superam o diretório do usuário
4. `~/.invowk/cmds` (apenas módulos, não-recursivo)

### default_runtime

**Tipo:** `"native" | "virtual" | "container"`  
**Obrigatório:** Não  
**Padrão:** `"native"`

Define o modo de runtime padrão global para comandos que não especificam um runtime preferido.

<Snippet id="reference/config/default-runtime-example" />

| Valor | Descrição |
|-------|-----------|
| `"native"` | Executar usando o shell nativo do sistema |
| `"virtual"` | Executar usando o interpretador de shell embutido do Invowk |
| `"container"` | Executar dentro de um container |

### virtual_shell

**Tipo:** `#VirtualShellConfig`  
**Obrigatório:** Não  
**Padrão:** `{}`

Configuração para o virtual shell runtime.

<Snippet id="reference/config/virtual-shell-example" />

### ui

**Tipo:** `#UIConfig`  
**Obrigatório:** Não  
**Padrão:** `{}`

Configuração de interface do usuário.

<Snippet id="reference/config/ui-example" />

### container

**Tipo:** `#ContainerConfig`  
**Obrigatório:** Não  
**Padrão:** `{}`

Configuração para o runtime container.

<Snippet id="reference/config/container-example" />

---

## VirtualShellConfig

Configuração para o virtual shell runtime (mvdan/sh).

<Snippet id="reference/config/virtual-shell-config-structure" />

### enable_uroot_utils

**Tipo:** `bool`  
**Obrigatório:** Não  
**Padrão:** `true`

Habilita utilitários u-root no ambiente virtual shell. Quando habilitado, fornece comandos adicionais além dos builtins básicos de shell.

<Snippet id="reference/config/enable-uroot-utils-example" />

**Utilitários disponíveis quando habilitado (28 no total):**
- Wrappers upstream (12): `base64`, `cat`, `cp`, `find`, `gzip`, `ls`, `mkdir`, `mv`, `rm`, `shasum`, `tar`, `touch`
- Implementações customizadas (16): `basename`, `cut`, `dirname`, `grep`, `head`, `ln`, `mktemp`, `realpath`, `seq`, `sleep`, `sort`, `tail`, `tee`, `tr`, `uniq`, `wc`

---

## UIConfig

Configuração de interface do usuário.

<Snippet id="reference/config/ui-config-structure" />

### color_scheme

**Tipo:** `"auto" | "dark" | "light"`  
**Obrigatório:** Não  
**Padrão:** `"auto"`

Define o esquema de cores para saída de terminal.

<Snippet id="reference/config/color-scheme-example" />

| Valor | Descrição |
|-------|-----------|
| `"auto"` | Detectar do terminal (respeita `COLORTERM`, `TERM`, etc.) |
| `"dark"` | Cores otimizadas para terminais escuros |
| `"light"` | Cores otimizadas para terminais claros |

### verbose

**Tipo:** `bool`  
**Obrigatório:** Não  
**Padrão:** `false`

Habilita saída verbose por padrão para todos os comandos.

<Snippet id="reference/config/verbose-example" />

Equivalente a sempre passar `--ivk-verbose` na linha de comando.

### interactive

**Tipo:** `bool`  
**Obrigatório:** Não  
**Padrão:** `false`

Habilita o modo interativo por padrão (buffer de tela alternativo com PTY).

<Snippet id="reference/config/interactive-example" />

---

## ContainerConfig

Configuração para comportamento do runtime container.

<Snippet id="reference/config/container-config-structure" />

### auto_provision

**Tipo:** `#AutoProvisionConfig`  
**Obrigatório:** Não  
**Padrão:** `{}`

Controla o provisionamento automático de recursos do invowk dentro de containers.

<Snippet id="reference/config/auto-provision-example" />

Com o auto-provisionamento habilitado, o Invowk cria uma imagem derivada em cache ao anexar uma pequena camada de provisionamento sobre a imagem base. Isso ocorre em toda execução de container (interativa ou não); se o provisionamento falhar, o Invowk avisa e usa a imagem base.

---

## AutoProvisionConfig

Configuração de auto-provisionamento para imagens container.

<Snippet id="reference/config/auto-provision-config-structure" />

### enabled

**Tipo:** `bool`
**Obrigatório:** Não
**Padrão:** `true`

Habilita o provisionamento automático do binário do invowk e módulos em containers.

### strict

**Tipo:** `bool`
**Obrigatório:** Não
**Padrão:** `false`

Faz com que falhas de provisionamento sejam erros fatais em vez de fazer fallback para a imagem base sem provisionamento. Quando `false` (o padrão), falhas de provisionamento geram um aviso e continuam com a imagem base.

### binary_path

**Tipo:** `string`  
**Obrigatório:** Não  
**Padrão:** *(vazio; usa o binário do invowk em execução)*

Sobrescreve o caminho do binário do invowk para provisionar.

### includes

**Tipo:** `[...#IncludeEntry]`
**Obrigatório:** Não
**Padrão:** `[]`

Módulos adicionais para provisionar em containers. Usa o mesmo formato `#IncludeEntry` do `includes` raiz (cada entrada tem um `path` terminando com `.invowkmod` e um `alias` opcional).

### inherit_includes

**Tipo:** `bool`
**Obrigatório:** Não
**Padrão:** `true`

Quando `true`, as entradas de `includes` do nível raiz são automaticamente herdadas pelo auto-provisionamento. Defina como `false` para provisionar apenas os módulos listados explicitamente em `container.auto_provision.includes`.

### cache_dir

**Tipo:** `string`  
**Obrigatório:** Não  
**Padrão:** `~/.cache/invowk/provision`

Sobrescreve o diretório de cache para metadados de imagens provisionadas.

---

## Exemplo Completo

Um arquivo de configuração totalmente documentado:

<Snippet id="reference/config/complete-example" />

---

## Configuração Mínima

Se você está satisfeito com os padrões, uma configuração mínima pode ser:

<Snippet id="reference/config/minimal-example" />

Ou até mesmo um arquivo vazio (todos os padrões):

<Snippet id="reference/config/empty-example" />

---

## Validação

Você pode validar seu arquivo de configuração usando CUE:

<Snippet id="reference/config/cue-validate" />

Ou verificá-lo com Invowk:

<Snippet id="reference/config/invowk-validate" />

Se houver algum erro, Invowk irá reportá-los ao carregar a configuração.
