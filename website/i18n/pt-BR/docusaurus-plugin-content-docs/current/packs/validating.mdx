---
sidebar_position: 3
---

import Snippet from '@site/src/components/Snippet';

# Validando Packs

Valide seus packs para garantir que estão estruturados corretamente e prontos para distribuição.

## Validação Básica

<Snippet id="packs/validate-basic" />

Saída para um pack válido:

<Snippet id="packs/validate-basic-output" />

## Validação Profunda

Adicione `--deep` para também fazer parse e validar o invkfile (quando presente):

<Snippet id="packs/validate-deep" />

Saída:

<Snippet id="packs/validate-deep-output" />

## O que é Validado

### Checagens de Estrutura

- Diretório do pack existe
- `invkpack.cue` obrigatório na raiz
- `invkfile.cue` é opcional (packs apenas de biblioteca são permitidos)
- Sem packs aninhados (exceto dentro de `invk_packs/`)

### Checagens de Segurança

- **Sem symlinks**: Symlinks não são permitidos em packs por motivos de segurança. Eles podem escapar do diretório do pack durante extração (vulnerabilidade zip-slip).

### Checagens de Compatibilidade

- **Nomes reservados no Windows**: Arquivos chamados `CON`, `PRN`, `AUX`, `NUL`, `COM1`-`COM9` ou `LPT1`-`LPT9` geram um aviso de compatibilidade. Esses nomes são reservados no Windows e podem causar problemas ao extrair packs em sistemas Windows.

### Checagens de Nomenclatura

- Nome da pasta termina com `.invkpack`
- Prefixo do nome segue as regras (começa com letra, alfanumérico + pontos)
- ID do pack em `invkpack.cue` corresponde ao prefixo do nome da pasta
- Sem caracteres inválidos (hífens, underscores)

### Checagens Profundas (com `--deep`)

- Invkfile faz parse sem erros (se presente)
- Sintaxe CUE é válida
- Restrições do schema são atendidas

## Erros de Validação

### Invkpack Ausente

<Snippet id="packs/error-missing-invkfile" />

### Nome Inválido

<Snippet id="packs/error-invalid-name" />

### Pack Aninhado

<Snippet id="packs/error-nested" />

### Invkfile Inválido (deep)

<Snippet id="packs/error-parse" />

## Validação em Lote

Valide múltiplos packs:

<Snippet id="packs/validate-batch" />

## Integração com CI

Adicione validação de packs no seu pipeline de CI:

<Snippet id="packs/validate-ci" />

## Problemas Comuns

### Separadores de Caminho Errados

<Snippet id="packs/path-separators-good-bad" />

### Escapando o Diretório do Pack

<Snippet id="packs/escape-pack-dir" />

### Caminhos Absolutos

<Snippet id="packs/absolute-paths" />

## Melhores Práticas

1. **Valide antes de commitar**: Detecte problemas cedo
2. **Use `--deep`**: Captura erros de invkfile
3. **Valide no CI**: Impede packs quebrados de sair
4. **Corrija problemas imediatamente**: Não deixe dívida de validação acumular

## Próximos Passos

- [Criando Packs](./creating-packs) - Estruture seu pack
- [Distribuindo](./distributing) - Compartilhe seu pack
