---
sidebar_position: 3
---

import Snippet from '@site/src/components/Snippet';

# Validando Módulos

Valide seus módulos para garantir que estão estruturados corretamente e prontos para distribuição.

## Validando um Módulo

<Snippet id="modules/validate-basic" />

Saída para um módulo válido com um invowkfile:

<Snippet id="modules/validate-deep-output" />

`invowk validate` sempre executa validação completa, incluindo parsing de invowkfile e verificações da árvore de comandos quando o módulo contém um `invowkfile.cue`.

## O que é Validado

### Checagens de Estrutura

- Diretório do módulo existe
- `invowkmod.cue` obrigatório na raiz
- `invowkfile.cue` é opcional (módulos apenas de biblioteca são permitidos)
- Sem módulos aninhados (exceto dentro de `invowk_modules/`)

### Checagens de Segurança

- **Sem symlinks**: Symlinks não são permitidos em módulos por motivos de segurança. Eles podem escapar do diretório do módulo durante extração (vulnerabilidade zip-slip).

### Checagens de Compatibilidade

- **Nomes reservados no Windows**: Arquivos chamados `CON`, `PRN`, `AUX`, `NUL`, `COM1`-`COM9` ou `LPT1`-`LPT9` geram um aviso de compatibilidade. Esses nomes são reservados no Windows e podem causar problemas ao extrair módulos em sistemas Windows.

### Checagens de Nomenclatura

- Nome da pasta termina com `.invowkmod`
- Prefixo do nome segue as regras (começa com letra, alfanumérico + pontos)
- ID do módulo em `invowkmod.cue` corresponde ao prefixo do nome da pasta
- Sem caracteres inválidos (hífens, underscores)

### Checagens de Invowkfile

Quando o módulo contém um `invowkfile.cue`, estas são sempre verificadas:

- Invowkfile faz parse sem erros
- Sintaxe CUE é válida
- Restrições do schema são atendidas
- Estrutura da árvore de comandos é válida (sem conflitos args + subcomandos)

## Erros de Validação

### Invowkmod Ausente

<Snippet id="modules/error-missing-invowkfile" />

### Nome Inválido

<Snippet id="modules/error-invalid-name" />

### Módulo Aninhado

<Snippet id="modules/error-nested" />

### Invowkfile Inválido

<Snippet id="modules/error-parse" />

## Validação em Lote

Valide múltiplos módulos:

<Snippet id="modules/validate-batch" />

## Integração com CI

Adicione validação de módulos no seu pipeline de CI:

<Snippet id="modules/validate-ci" />

## Problemas Comuns

### Separadores de Caminho Errados

<Snippet id="modules/path-separators-good-bad" />

### Escapando o Diretório do Módulo

<Snippet id="modules/escape-module-dir" />

### Caminhos Absolutos

<Snippet id="modules/absolute-paths" />

## Melhores Práticas

1. **Valide antes de commitar**: Detecte problemas cedo
2. **Valide no CI**: Impede módulos quebrados de sair
3. **Corrija problemas imediatamente**: Não deixe dívida de validação acumular

## Próximos Passos

- [Criando Módulos](./creating-modules) - Estruture seu módulo
- [Distribuindo](./distributing) - Compartilhe seu módulo
