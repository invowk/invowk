---
sidebar_position: 3
---

import Snippet from '@site/src/components/Snippet';

# Validating Modules

Validate your modules to ensure they're correctly structured and ready for distribution.

## Validating a Module

<Snippet id="modules/validate-basic" />

Output for a valid module with an invowkfile:

<Snippet id="modules/validate-deep-output" />

`invowk validate` always performs full validation, including invowkfile parsing and command tree checks when the module contains an `invowkfile.cue`.

## What Gets Validated

### Structure Checks

- Module directory exists
- Required `invowkmod.cue` at root
- `invowkfile.cue` is optional (library-only modules are allowed)
- No nested modules (except inside `invowk_modules/`)

### Security Checks

- **No symlinks**: Symlinks are not allowed in modules for security reasons. They could potentially escape the module directory during extraction (zip-slip vulnerability).

### Compatibility Checks

- **Windows reserved filenames**: Files named `CON`, `PRN`, `AUX`, `NUL`, `COM1`-`COM9`, or `LPT1`-`LPT9` will trigger a compatibility warning. These names are reserved on Windows and could cause issues when extracting modules on Windows systems.

### Naming Checks

- Folder name ends with `.invowkmod`
- Name prefix follows rules (starts with letter, alphanumeric + dots)
- Module ID in `invowkmod.cue` matches the folder name prefix
- No invalid characters (hyphens, underscores)

### Invowkfile Checks

When the module contains an `invowkfile.cue`, these are always checked:

- Invowkfile parses without errors
- CUE syntax is valid
- Schema constraints are met
- Command tree structure is valid (no args + subcommand conflicts)

## Validation Errors

### Missing Invowkmod

<Snippet id="modules/error-missing-invowkfile" />

### Invalid Name

<Snippet id="modules/error-invalid-name" />

### Nested Module

<Snippet id="modules/error-nested" />

### Invalid Invowkfile

<Snippet id="modules/error-parse" />

## Batch Validation

Validate multiple modules:

<Snippet id="modules/validate-batch" />

## CI Integration

Add module validation to your CI pipeline:

<Snippet id="modules/validate-ci" />

## Common Issues

### Wrong Path Separators

<Snippet id="modules/path-separators-good-bad" />

### Escaping Module Directory

<Snippet id="modules/escape-module-dir" />

### Absolute Paths

<Snippet id="modules/absolute-paths" />

## Best Practices

1. **Validate before committing**: Catch issues early
2. **Validate in CI**: Prevent broken modules from shipping
3. **Fix issues immediately**: Don't let validation debt accumulate

## Next Steps

- [Creating Modules](./creating-modules) - Structure your module
- [Distributing](./distributing) - Share your module
