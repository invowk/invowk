---
sidebar_position: 1
---

import Snippet from '@site/src/components/Snippet';

# Environment Overview

Invowkâ„¢ provides powerful environment variable management for your commands. Set variables, load from files, and control precedence across multiple levels.

## Quick Example

<Snippet id="environment/overview-quick-example" />

## Environment Sources

Variables come from multiple sources, applied in this order (lowest to highest precedence):

1. **System environment** - Host's environment variables (subject to `env_inherit_mode`)
2. **Root files** - Root-level `env.files`
3. **Command files** - Command-level `env.files`
4. **Implementation files** - Implementation-level `env.files`
5. **Root vars** - Root-level `env.vars`
6. **Command vars** - Command-level `env.vars`
7. **Implementation vars** - Implementation-level `env.vars`
8. **Invowk vars** - Built-in command vars (`INVOWK_*`, `ARG*`)
9. **CLI env files** - `--ivk-env-file .env.custom`
10. **CLI env vars** - `--ivk-env-var KEY=value`

Later sources override earlier ones.

## Scope Levels

### Root Level

Applies to all commands in the invowkfile:

<Snippet id="environment/scope-root" />

### Command Level

Applies to a specific command:

<Snippet id="environment/scope-command" />

### Implementation Level

Applies to a specific implementation:

<Snippet id="environment/scope-implementation" />

### Platform Level

Set variables per platform:

<Snippet id="environment/scope-platform" />

## Env Files

Load variables from `.env` files:

<Snippet id="environment/env-files" />

Files are loaded in order; later files override earlier ones.

See [Env Files](./env-files) for details.

## Environment Variables

Set variables directly:

<Snippet id="environment/env-vars" />

See [Env Vars](./env-vars) for details.

## CLI Overrides

Override at runtime:

<Snippet id="environment/cli-overrides" />

## Host Environment Inheritance

By default, native and virtual runtimes inherit the host environment, while container runtime starts with no host variables. You can control this per runtime or per invocation.

<Snippet id="reference/invowkfile/env-inherit-example" />

<Snippet id="environment/env-inherit-cli" />

## Built-in Variables

Invowk provides variables for flags and arguments:

- `INVOWK_FLAG_*` - Flag values
- `INVOWK_ARG_*` - Argument values

Additionally, invowk injects metadata variables during command execution:

| Variable | Description | Always Set |
|----------|-------------|------------|
| `INVOWK_CMD_NAME` | Current command name | Yes |
| `INVOWK_RUNTIME` | Resolved runtime name (`native`, `virtual`, `container`) | Yes |
| `INVOWK_SOURCE` | Source origin (`invowkfile` for root commands, module name for module commands) | Yes |
| `INVOWK_PLATFORM` | Resolved platform (`linux`, `macos`, `windows`) | Yes |

## Container Environment

For container runtime, environment is passed into the container:

<Snippet id="environment/container-env" />

## Nested Commands

When a command invokes another command, some variables are isolated:

**Isolated (NOT inherited):**
- `INVOWK_ARG_*`
- `INVOWK_FLAG_*`

**Inherited (normal UNIX behavior):**
- Variables from `env.vars`
- Platform-level variables
- System environment

This prevents parent command arguments from leaking into child commands.

## Next Steps

- [Env Files](./env-files) - Load from .env files
- [Env Vars](./env-vars) - Set variables directly
- [Precedence](./precedence) - Understand override order
